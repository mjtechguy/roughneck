================================================================================
                     ROUGHNECK DEPLOYMENT SUMMARY
================================================================================

Deployment completed: {{ ansible_date_time.iso8601 }}
Target server: {{ inventory_hostname }} ({{ ansible_distribution }} {{ ansible_distribution_version }})

--------------------------------------------------------------------------------
INSTALLED COMPONENTS
--------------------------------------------------------------------------------

Shell & Core Tools:
  ✓ Zsh                 {{ zsh_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first | default('installed') }} (oh-my-zsh)
  ✓ Go                  {{ go_version_output.stdout | regex_search('go([0-9.]+)', '\\1') | first }}
  ✓ Git                 {{ git_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first }}
  ✓ GitHub CLI          {{ gh_version_output.stdout_lines[0] | regex_search('([0-9.]+)', '\\1') | first | default('installed') }}
  ✓ tmux                {{ tmux_version_output.stdout | regex_replace('tmux ', '') }}
  ✓ Node.js             {{ node_version_output.stdout | regex_replace('v', '') }}
  ✓ npm                 {{ npm_version_output.stdout }}

Container Platform:
  ✓ Docker              {{ docker_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first }}
  ✓ Docker Compose      {{ compose_version_output.stdout | regex_search('v([0-9.]+)', '\\1') | first }}

Development Environment:
  ✓ code-server         {{ codeserver_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first | default('installed') }}
  ✓ Caddy               {{ caddy_version_output.stdout | default('installed') }} (TLS proxy)
{% if enable_autocoder | default(false) | bool %}
  ✓ AutoCoder           installed (autonomous coding agent)
{% endif %}
  ✓ direnv              {{ direnv_version_output.stdout | default('installed') }}
  ✓ mise                {{ mise_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first | default('installed') }}
  ✓ lazygit             {{ lazygit_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first | default('installed') }}
  ✓ lazydocker          {{ lazydocker_version_output.stdout | regex_search('([0-9.]+)', '\\1') | first | default('installed') }}
{% if enable_k9s | default(false) | bool %}
  ✓ k9s                 {{ k9s_version_output.stdout | default('installed') }}
{% endif %}

AI Coding Assistants:
  ✓ Claude Code CLI     {{ claude_version_output.stdout | default('installed') }}
  ✓ Codex CLI           {{ codex_version_output.stdout | default('installed') }}
  ✓ Gemini CLI          {{ gemini_version_output.stdout | default('installed') }}
  ✓ Copilot CLI         {{ 'installed' if 'gh-copilot' in (copilot_version_output.stdout | default('')) else 'not found' }}
{% if enable_gastown | default(false) | bool %}

Optional (Gas Town Ecosystem):
  ✓ Gas Town (gt)       {{ gt_version_output.stdout | default('installed') }}
{% if enable_beads | default(false) | bool %}
  ✓ beads               {{ 'installed' if beads_installed.stat.exists else 'not found' }}
{% endif %}
{% endif %}

--------------------------------------------------------------------------------
SERVICE STATUS
--------------------------------------------------------------------------------

  {{ '✓' if docker_service_status.stdout == 'active' else '✗' }} docker              [{{ docker_service_status.stdout | upper }}]
  {{ '✓' if codeserver_service_status.stdout == 'active' else '✗' }} code-server         [{{ codeserver_service_status.stdout | upper }}] - localhost:10080
  {{ '✓' if caddy_service_status.stdout | default('inactive') == 'active' else '✗' }} caddy               [{{ caddy_service_status.stdout | default('inactive') | upper }}] - TLS proxy
{% if enable_autocoder | default(false) | bool %}
  {{ '✓' if autocoder_service_status.stdout | default('inactive') == 'active' else '✗' }} autocoder           [{{ autocoder_service_status.stdout | default('inactive') | upper }}] - localhost:51730
{% endif %}
{% if enable_systemd_services | default(false) | bool %}
  {{ '✓' if mayor_service_status.stdout == 'active' else '✗' }} roughneck-mayor     [{{ mayor_service_status.stdout | upper }}]
  {{ '✓' if deacon_service_status.stdout == 'active' else '✗' }} roughneck-deacon    [{{ deacon_service_status.stdout | upper }}]
{% endif %}

--------------------------------------------------------------------------------
ACCESS INFORMATION
--------------------------------------------------------------------------------

All services are protected with TLS and basic authentication.
Username: roughneck
Password: {{ codeserver_password }}

SSH Access:
  ssh -i {{ ansible_ssh_private_key_file }} roughneck@{{ inventory_hostname }}

Web IDE (code-server):
{% if enable_letsencrypt | default(false) | bool and domain_name is defined and domain_name != '' %}
  URL:      https://code.{{ domain_name }}
{% if tls_mode | default('http01') == 'dns01' %}
  TLS:      Wildcard certificate (*.{{ domain_name }})
{% else %}
  TLS:      Let's Encrypt (HTTP-01)
{% endif %}
{% else %}
  URL:      https://{{ inventory_hostname }}:10000  (self-signed cert)
  Note:     Accept the self-signed certificate warning in your browser
{% endif %}
{% if enable_autocoder | default(false) | bool %}

AutoCoder (autonomous coding agent):
{% if enable_letsencrypt | default(false) | bool and domain_name is defined and domain_name != '' %}
  URL:      https://autocoder.{{ domain_name }}
{% else %}
  URL:      https://{{ inventory_hostname }}:10001  (self-signed cert)
{% endif %}
  Note:     Requires Claude CLI login first (claude login)
{% endif %}

Configuration (run 'setup' to configure all):
  Git:      Set user.name and user.email
  Claude:   claude login
  Codex:    Set OPENAI_API_KEY
  Gemini:   Set GOOGLE_API_KEY
  Copilot:  gh auth login
{% if enable_gastown | default(false) | bool %}

Gas Town:
  Start:    cd ~/gt && gt start
  Binary:   ~/go/bin/gt
{% endif %}

--------------------------------------------------------------------------------
NEXT STEPS
--------------------------------------------------------------------------------

1. SSH into the server as the 'roughneck' user
2. Run 'setup' to configure Git and AI assistants
{% if enable_letsencrypt | default(false) | bool and domain_name is defined and domain_name != '' %}
3. Access code-server in your browser at https://code.{{ domain_name }}
{% else %}
3. Access code-server in your browser at https://{{ inventory_hostname }}:10000
{% endif %}
4. Use lazygit/lazydocker for visual Git/Docker management
5. Configure mise for per-project tool versions
{% if enable_gastown | default(false) | bool %}
6. Initialize Gas Town: cd ~/gt && gt start
{% endif %}

Report saved to: /home/roughneck/installation-summary.txt

================================================================================
